%*******************************************************************************
%****************************** Fourth Chapter *********************************%*******************************************************************************
			\chapter{Experiments} \label{chapter4}

% **************************** Define Graphics Path **************************
%\ifpdf
%    \graphicspath{{chapter5/figs/raster/}{chapter5/figs/PDF/}{chapter5/figs/}}
%\else
%    \graphicspath{{chapter5/figs/vector/}{chapter5/figs/}}
%\fi
%

\graphicspath{{figs/chapter4/PDF/}}


%%**************************** %Broad Purpose  *********************************
%\section*{Summary and broad purpose of the chapter}
%* How long (number of words)?


\section{Aims}
Not only tackling the weaknesses and robustness of RSS, UTDE, embedding 
parameters, RP and RQA metrics regarding different conditions for 
time-series (smoothness, windowsizes and structures), but also 
considering the models of \cite{stergiou2006} and 
\citep{vaillancourt2002, vaillancourt2003} for movement movement variability, 
we design two experiments in the context of human-humanoid interaction
where participants perform simple arm movements repetitions.


\section{Participants}
For this thesis, twenty-three participants, from now on defined as $pN$ 
where $N$ is the number of participant, were invited for two experiments of 
simple arm movements. Although the same number of participants were invited
for the experiments, different number of participants were take into account 
for each of the experiments.


\subsection{Human-Image Imitation Activities}





\subsection{Human-Humanoid Imitation Activities}
For the experiment of Human-Humanoid Imitation Activities, 
data for only twenty participants were analysed since the instructions 
for $p01$, who was the only left-handed, were mistakenly given in a way 
that movements were performed different from what had been planned, 
and for participants $p13$ and $p16$ data were corrupted because 
bluetooth communications problems with the sensors. 
With that in mind, all of the 20 participants were right-handed 
healthy participants, being four females and sixteen males, with 
a mean and standard deviation (SD) age of mean=19.8 (SD=1.39) years.





\section{Equipment}
During the experiments, time series were collected with four neMEMSi 
Inertial Measurement Units (IMUs) using a sampling rate of 50Hz 
\citep{Comotti2014}. neMEMSi sensors provide tri-axial time series from 
the accelerometer, gyroscope and magnetometer sensors and quaternions.
A further technical information regarding the NeMEMSi IMU sensors is 
given in Appendix \ref{appendix:imus}.
For the human-humanoid imitation activities, NAO, a humanoid robot from 
Aldebaran \citep{gouaillier2009}, were programmed with choreographer 
to perform horizontal and vertical arm movements.
A further technical information regarding NAO and the code of NAO's
movements is given in Appendix \ref{appendix:nao}



\section{Ethics}
For the experiments of this thesis conducted in November 2016, 
participants confirmed reading and understanding the participant information 
sheet for the experiments and were able to withdraw from the experiment 
at any time without giving any reason.
The design of the experiments is adhered to University of Birmingham 
regulations and data were anonymised and stored only a personal 
computer in accordance with the Data Protection Act 1998.
For further information about the ethics, online participation 
information sheets and experiment check list, refer to 
Appendix \ref{appendix:c}.


\section{Experiments}

\subsection{Human-Image Imitation Activities}

For the human-image imitation (HHI) experiment four wearable IMUs sensors 
were used and attached to the right hand of the participant 
(Figure~\ref{fig:hii} A,D). 
Participants performed two experiments: 
(i) an unconstrained arm movement imitation activity
where participants only receive instructions and look an images 
of the movement and,
(ii) a constrained experiment where participants hear a beat 
to synchronise their arm movements.


\subsubsection{Arm movements following an image while not hearing a beat}

Participants received instructions to perform upper arm 
movements while only looking an image of: 
\begin{itemize}[noitemsep,topsep=0pt]
\item ten repetitions of horizontal arm movement at their comfortable speed
(Fig. \ref{fig:hii}(A, B, C)), 
\item ten repetitions of vertical arm movement at their comfortable speed 
(Fig. \ref{fig:hii}(D, F, E)),
\item ten repetitions of horizontal arm movement at a faster speed than 
the comfortable speed but not at their fastest speed 
(Fig. \ref{fig:hii}(A, B, C)), and 
\item ten repetitions of vertical arm movement at a faster speed than the 
comfortable speed but not at their fastest speed
(Fig. \ref{fig:hii}(D, F, E)).
\end{itemize}

\subsubsection{Arm movements following an image while hearing a beat}

Participants received instructions to perform upper arm movements while 
listening a beat to constraint their movements. 
\begin{itemize}[noitemsep,topsep=0pt]
\item ten repetitions of horizontal arm movement at normal speed
(Fig. \ref{fig:hii}(A, B, C)), 
\item ten repetitions of vertical arm movement at normal speed
(Fig. \ref{fig:hii}(D, F, E)), 
\item ten repetitions of horizontal arm movement at faster speed and
(Fig. \ref{fig:hii}(A, B, C)), and 
\item ten repetitions of vertical arm movement at faster speed
(Fig. \ref{fig:hii}(D, F, E)).
\end{itemize}



%%---------------------------------(FIGURE)-------------------------------------
\begin{figure}
  \centering
  \includegraphics[width=1.0\textwidth]{hii}
    \caption{
	{\bf Human-image imitation (HII) activities.} 
		%Human-image imitation (HHI) activities for 
		(A) HII of horizontal arm movement, 
		(B) image of the profile view for horizontal arm movement,
		(C) image of the top view for horizontal arm movement,
		(D) HII of vertical arm movement, 
		(E) image of the profile view for vertical arm movement, and
		(F) image of the top view for horizontal arm movement.
		(B, C, F and E) show '(((BEAT)))' to indicate the participants
		arm movements synchronisation when hearing a beat.
        }
    \label{fig:hii}
\end{figure}
%%---------------------------------(FIGURE)------------------------------------







\subsection{Human-Humanoid Imitation Activities} % \label{sec:experiment}
For the human-humanoid imitation (HHI) experiment four wearable IMUs sensors 
were used in which two sensors were attached to the right hand of 
the participant and two sensors were attached to the left hand of 
the humanoid robot (Figure~\ref{fig:hri} A,C).
Then, in the face-to-face imitation activity each participant was asked 
to imitate repetitions of simple horizontal and vertical arm movements 
performed by the humanoid robot in the following conditions:
\begin{itemize}[noitemsep,topsep=0pt]
\item ten repetitions of horizontal arm movement at normal (HN) and faster (HF) 
speed (Fi.~\ref{fig:hri} A), and
\item ten repetitions of vertical arm movement at normal (VN) and faster (VF) 
speed (Fig.~\ref{fig:hri} C).
\end{itemize}
%%---------------------------------(FIGURE)-------------------------------------
\begin{figure}
  \centering
  \includegraphics[width=1.0\textwidth]{hri}
    \caption{
	{\bf Human-humanoid imitation activities.} 
		Face-to-face human-humanoid imitation (HHI) activities for 
		(A) HHI of horizontal arm movement, 
		(B) Humanoid horizontal arm movement,
		(C) HHI of vertical arm movement, and 
		(D) Humanoid vertical arm movement.
        }
    \label{fig:hri}
\end{figure}
%%---------------------------------(FIGURE)------------------------------------
The normal and faster speed of arm movements is defined by the duration in 
number of samples of one repetition of NAO's arm movements.
We select NAO's arm movements duration to distinguish between normal and 
faster arm movements as the movements from the humanoid robot have less 
variation between repetition to repetition. 
The duration for one repetition of the horizontal 
arm movement at normal speed, HN, is about 5 seconds considering that 
each repetition last around 250 samples. For horizontal arm movement at 
faster speed, HF, each repetition were performed in around 2 seconds 
which correspond to 90 samples of data. 
The vertical arm movement at normal speed, VN, were performed  in 6 seconds 
which is around 300 samples of data.
For vertical arm movement at faster speed, VF, each repetition lasts 
about 2.4 seconds which correspond to 120 samples of data.
To visualise the distinction between normal and faster speed for horizontal 
and vertical arm movements, Fig~\ref{fig:sts} shows smoothed time series 
for axes Z and Y of the gyroscope sensors with four window lengths: 
2-sec (100-samples), 5-sec (250-samples), 10-sec (500-samples) 
and 15-sec (750-samples).
%%---------------------------------(FIGURE)-------------------------------------
\begin{figure}[!h] 
  \centering
  \includegraphics[width=1.0\textwidth]{sts}
    \caption{
	{\bf Time series duration of horizontal and vertical arm movements.} 
		Time series of smoothed data from gyroscope sensor 
		for different speed arm movements performed by NAO: 
		(A) Horizontal Normal arm movement, HN, 
		(B) Horizontal Faster arm movement, HF,
		(C) Vertical Normal arm movement, VN, and 
		(D) Vertical Faster arm movement, VF.
		Additionally, (A) shows window sizes for 2-seconds 
		(100 samples), 5-seconds (250 samples), 
		10-seconds (500 samples) and 15-seconds (750 samples)
		which are also presented in (B), (C) and (D).
		R code to reproduce the figure is available \cite{hwum2018}.
        }
	\label{fig:sts}
\end{figure}
%%---------------------------------(FIGURE)------------------------------------

\section{Preparation of time series} \label{sec:preparation_timeseries}
%\subsection{Time-series from Inertial Measurement Units} 

\subsection{Raw time-series}
Considering the work of \cite{shoaib2016} which provided evidence 
of an improvement in recognition activities when combining data 
from accelerometer and gyroscope.
We focus our analysis for time series of the accelerometer and gyroscope only
of the IMU sensors and leave the time series of the magnetometer and 
quaternions for future investigations because of their possible variations 
with regard to magnetic disturbances.

Time series from the accelerometer are defined by triaxial time series 
$A_x(n)$, $A_y(n)$, $A_z(n)$ which forms the matrix $\boldsymbol{A}$ 
(Eq.~\ref{eq:A}), and the same for data from the gyroscope which is 
defined by triaxial time-series of $G_x(n)$, $G_y(n)$, $G_z(n)$ representing 
the matrix $\boldsymbol{G}$ (Eq.~\ref{eq:G}). Both triaxial time series of 
each sensor, $a$ and $g$, are denoted with its respective axes 
subscripts $x,y,z$, where $n$ is the sample index  and $N$ is the same 
maximum length of all axes for the time series.
Matrices  $\boldsymbol{A}$ and $\boldsymbol{G}$ are represented as follow
%%---------------------------------(EQUATION)-----------------------------------
\begin{equation}\label{eq:A}
\boldsymbol{A} =
\begin{pmatrix}
  A_x(n) \\
  A_y(n) \\
  A_z(n)
\end{pmatrix}
=
\begin{pmatrix}
 a_x(1),a_x(2),\dots,a_x(N) \\
 a_y(1),a_y(2),\dots,a_y(N) \\
 a_z(1),a_z(2),\dots,a_z(N) 
\end{pmatrix},
\end{equation}
%%---------------------------------(EQUATION)-----------------------------------
%%---------------------------------(EQUATION)-----------------------------------
\begin{equation}\label{eq:G}
\boldsymbol{G} =
\begin{pmatrix}
 G_x(n) \\
 G_y(n) \\
 G_z(n)
\end{pmatrix}
=
\begin{pmatrix}
 g_x(1),g_x(2),\dots,g_x(N) \\
 g_y(1),g_y(2),\dots,g_y(N) \\
 g_z(1),g_z(2),\dots,g_z(N) 
\end{pmatrix},
\end{equation}
%%---------------------------------(EQUATION)-----------------------------------
where $n$ is the sample index  and $N$ is the same maximum length of all axes 
for the time series.


\subsection{Postprocessing time-series}
After the collection of raw time-series from four NeMEMsi sensors,
time synchronisation alignment and interpolation were performed 
in order to create time series with the same length and synchronised time.
We refer the reader to Appendix~\ref{appendix:b} for technical information 
about the time synchronisation process and IMU sensors.

\subsection{Normalization of time-series}
Tim series are normalised to have zero mean and unit variance 
using sample mean and sample standard deviation \citep{loffe2015}.
The sample mean and sample standard deviation using $x(n)$ is given by
%%---------------------------------(EQUATION)-----------------------------------
\begin{equation}\label{eq:ms}
\mu_{x(n)}= \frac{1}{N} ( \sum_{i=1}^N x(i) ), \quad  \sigma_{x(n)} =  \sqrt{ \frac{  \sum_{1=1}^N ( x(i) - \mu_{x(n)} )^2 }{ N-1 }  },      
\end{equation}
%%---------------------------------(EQUATION)-----------------------------------
then the normalised data, $\hat{x}(n)$, is computed as follows
%%---------------------------------(EQUATION)-----------------------------------
\begin{equation}\label{eq:normalization}
\hat{x} (n) = \frac{   x(n) -  \mu_{x(n)}  }{   \sigma_{x(n)} }.   
\end{equation}
%%---------------------------------(EQUATION)-----------------------------------

\subsection{Smoothing time-series}
Using a low-pass filter is the common way to either capture the low 
frequencies that represent \%99 of the human body energy or to get the 
gravitational and body motion components of accelerations \citep{anguita2013}.
However, for this thesis the main focus in on the conservation of the 
structure of the time series in terms of the width and heights where, 
for instance, Savitzky-Golay filter can help to accomplish such task 
\citep{press1992}. Savitzky-Golay filter is based on the principle of moving 
window average which preserves the area under the curve (the zeroth moment)
and its mean position in time (the first moment) but the line width 
(the second moment) is violated and that results, for example, in the case 
of spectrometric data where a narrow spectral line is presented with 
reduced height and width. 
The aim of Savitzky-Golay filtering is to find the filter coefficients 
$c_n$ that preserve higher momentums which are based on local least-square 
polynomial approximations 
\citep{savitzkygolay1964, press1992, schafer2011}.
Hence, Savitzky-Golay coefficients are therefore computed using an R function 
\texttt{sgolay(p,n,m)} where \texttt{p} is the filter order, 
\texttt{n} is the filter length (must be odd) 
and \texttt{m} is the $m$-th derivative of the filter coefficients 
\citep{Rsignal}. Smoothed signal is represented with a tilde over the 
original signal: $\tilde{x}(n)$.



\subsection{Window size of time-series}
With regard to the window size, \cite{shoaib2016} investigated its effects 
using seven window lengths (2, 5, 10, 15, 20, 25, 30 seconds)
and combination of inertial sensors (accelerometer, gyroscope and linear 
acceleration sensor) in activity recognition performance for repetitive 
activities (walking, jogging and biking) and less repetitive activities 
(smoking, eating, giving a talk or drinking a coffee).
Similarly, \cite{shoaib2016} experimented with different window size effect 
to conclude that the increase of window size improved the recognition of 
complex activities because these required a large window to learn the 
repetitive motion patterns. Also, \cite{shoaib2016} concluded that the use 
of large window size improve the recognition performance of less repetitive 
activities which mainly involve random hand gestures.

For the activities in this thesis which are mainly repetitive, we selected 
only four window sizes: 2-s window (100 samples), 5-s window (250 samples), 
10-s (500 samples) and 15-s window (750 samples) (Figure~\ref{fig:sts}).




