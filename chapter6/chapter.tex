%*******************************************************************************
%****************************** Fifth Chapter *********************************
%*******************************************************************************

\chapter{Quantifying Human-Humanoid Imitation Activities} \label{chapter6}
%
%% **************************** Define Graphics Path **************************
%\ifpdf
%    \graphicspath{{chapter7/figs/raster/}{chapter7/figs/PDF/}{chapter7/figs/}}
%\else
%    \graphicspath{{chapter7/figs/vector/}{chapter7/figs/}}
%\fi
\graphicspath{{figs/chapter6/PDF/}}

%%**************************** %Broad Purpose  **********************************
%\section*{Summary and broad purpose of the chapter}
%* How long (number of words)?

\section{Introduction} 
Considering the experiment of Human-Humanoid Imitation Activities
(Section \ref{sec:experiment:hhi}), 
we investigated the robustness and weaknesses of the reconstructed 
state spaces (RSSs) using the uniform time-delay embedding technique (UTDE) 
and recurrence plots (RPs) for recurrent quantification analysis (RQA) 
methodologies with the following conditions: 
\begin{itemize}

\item Three levels of smoothness for the normalised data 
(sg0zmuv, sg1zmuv and sg2zmuv), computed from two different filter 
lengths (29 and 159) with the same polynomial degree of 5 using the 
function \texttt{sgolay(p,n,m)} \citep{Rsignal},

\item Four velocities of arm movement activity: horizontal normal (HN), 
	horizontal faster (HF), vertical normal (VN), and 
	vertical faster (VF), and
\item Four window lengths: 2-sec (100 samples), 5-sec (250 samples), 
	10-sec (500 samples) and 15-sec (750 samples).
\end{itemize}

Further details about the processing of time series are presented in
Section \ref{sec:preparation_timeseries}.

\section{Time series}
To make visual comparison easier, we only present 10-sec (500 samples) 
window length time series for three participants ($p01$, $p02$ and $p03$) 
performing horizontal 
arm movements using axis GyroZ (Figs. \ref{fig:tsH})
and  vertical arm movements using axis GyroY (Figs. \ref{fig:tsV}). 
Other data are presented in 
Appendix \ref{appendix:d}.
We consider different levels of smoothness of the normalised data 
with two different Savitzky-Golay filter lengths (29 and 159) 
with the same polynomial degree of 5 using \texttt{sgolay(p,n,m)} 
\citep{Rsignal}. 
%%---------------------------------(FIGURE)-------------------------------------
\begin{figure}[!h]
  \centering
\includegraphics[width=1.0\textwidth]{tsHv03}
    	\caption{ 
	{\bf Time series for horizontal arm movements.}
		(A) raw-normalised (sg0zmuvGyroZ), 
		(B) normalised-smoothed 1 (sg1zmuvGyroZ) and
		(C) normalised-smoothed 2 (sg2zmuvGyroZ).
		Time series are only for three participants 
		($p01$, $p02$, and $p03$) 
		for horizontal movements in normal and faster velocity (HN, HF) 
		with the normalised GyroZ axis (zmuvGyroZ) 
		and with one sensor attached to the participant (HS01) 
		and other sensor attached to the robot (RS01).	
	R code to reproduce the figure is available from \cite{hwum2018}.
        }
    \label{fig:tsH}
\end{figure}
%%---------------------------------(FIGURE)------------------------------------
%%---------------------------------(FIGURE)-------------------------------------
\begin{figure}[!h]
  \centering
\includegraphics[width=1.0\textwidth]{tsVv03}
	\caption{ 
	{\bf Time series for vertical arm movements.}
		(A) raw-normalised (sg0zmuvGyroY), 
		(B) normalised-smoothed 1 (sg1zmuvGyroY) and
		(C) normalised-smoothed 2 (sg2zmuvGyroY).
		Time series are only for three participants 
		($p01$, $p02$, and $p03$) 
		for vertical movements in normal and faster velocity (VN, VF) 
		with the normalised GyroY axis (zmuvGyroY) 
		and with one sensor attached to the participant (HS01) 
		and other sensor attached to the robot (RS01).
		R code to reproduce the figure is available 
		from \cite{hwum2018}.
        }
    \label{fig:tsV}
\end{figure}
%%---------------------------------(FIGURE)------------------------------------







\section{Minimum Embedding Parameters}
The first step to create RSSs with the use of UTDE is to compute the
average minimum embedding parameters for all participants, sensors and 
activities using False Nearest Neighbour (FNN) and 
Average Mutual Information algorithms (AMI).

Hence, for the average minimum embedding dimension, 
Figs \ref{fig:caoH} and \ref{fig:caoV} show the minimum embedding 
dimension for twenty participants for the horizontal and vertical arm
movements at normal and faster velocity (HN, HF, VN, and VF) with the 
human attached sensor (HS01) and robot attached sensor (RS01).
Generally, Figs \ref{fig:caoH} and \ref{fig:caoV} show that the minimum 
embedding values appear to be more constant for sensor RS01 than the 
slightly variations for embedding values for sensor HS01.
It can also be seen in Figs~\ref{fig:caoH} and \ref{fig:caoV} that there 
is a minor decrease of minimum embedding values as smoothness of time 
series increase. 


%%---------------------------------(FIGURE)-------------------------------------
\begin{figure}
\centering
\includegraphics[width=1.0\textwidth]{CAO}
	\caption{
	{\bf Minimum embedding dimensions.} 
		(A, B) Horizontal Normal (HN), (C, D) Horizontal Faster (HF) 
		movements,
		(A, C) sensor attached to participants (HS01), and
		(B, D) sensor attached to robot (RS01).
		Minimum embedding dimensions are for twenty participants 
		(p01 to p20) with three smoothed signals 
		(sg0zmuvGyroZ, sg1zmuvGyroZ and sg2zmuvGyroZ)
		and window lenght of 10-sec (500 samples).
		R code to reproduce the figure is available 
		from \cite{hwum2018}.
        }
    \label{fig:CAO}
\end{figure}
%%---------------------------------(FIGURE)------------------------------------




Similarly, the first minimum values of the Average Mutual Information (AMI) 
for participants (p01-p20), activities (HN, HF, VN, and VF) and 
sensors (HS01, RS01) is shown in Figs~\ref{fig:amiH} and \ref{fig:amiV}.
Hence, Fig~\ref{fig:amiH}(A) shows that the first minimum values of AMI,
for normal horizontal arm movements, tend to be more spread as the smoothness 
of the time series is increasing while AMI values for faster horizontal arm 
movements in Fig~\ref{fig:amiH}(C) show little effect with regards
to its fluctuation as the smoothness of time series increase.
Fig~\ref{fig:amiH}(B) shows that minimum values of AMI are 
less spread as smoothness is increasig. However, values for horizontal
faster movements in Fig~\ref{fig:amiH}(D) tend to be more spread as 
smoothness is increasing.
%the high frequencies on robots movements in the horizontal normal movement.
With regard to vertical arm movements,
the minimum values of AMI in Figs~\ref{fig:amiV}(A) and ~\ref{fig:amiV}(C) 
show a slightly increase of the spread values as the smoothness is increasing
and minimum AMI values in Fig~\ref{fig:amiV}(B) appear to have less 
fluctuation as the smoothness of the time series is increasing. However, 
that does not happen for the second smoothed values (sg2zmuvGyroY) in 
Fig~\ref{fig:amiV}(D) which appear to be constant.
It can be noted that the increase of fluctuations of minimum AMI values 
in Figs~\ref{fig:amiH} and \ref{fig:amiV} is due to the smoothed curves in 
the AMIs as the smoothness of time series is increasing.


%%---------------------------------(FIGURE)-------------------------------------
\begin{figure}
\centering
\includegraphics[width=1.0\textwidth]{AMI}
	\caption{
	{\bf First minimum AMI values.} 
		(A, B) Horizontal Normal (HN), (C, D) Horizontal Faster (HF) 
		movements,
		(A, C) sensor attached to participants (HS01), and
		(B, D) sensor attached to robot (RS01).
		Minimum embedding dimensions are for twenty participants 
		(p01 to p20) with three smoothed signals 
		(sg0zmuvGyroZ, sg1zmuvGyroZ and sg2zmuvGyroZ)
		and window lenght of 10-sec (500 samples).
		R code to reproduce the figure is available 
		from \cite{hwum2018}.
        }
    \label{fig:AMI}
\end{figure}
%%---------------------------------(FIGURE)------------------------------------



\newpage
\section{Reconstructed state spaces with UTDE}
Although the implementation of Uniform Time-Delay Embedding (UTDE) 
is simple, the main challenge in this regard is to select embedding parameters 
to reconstruct the state spaces for each time series, considering that time 
series are unique in terms of its structure (modulation of amplitude, 
frequency and phase) \citep{ frank2010, sama2013, bradley2015}.
With that in mind, the problem is not to compute individual embedding 
parameters for each of the time series but to deal with the selection of 
two parameters that can represent all the time series. 
Our solution for that problem was, therefore, to compute a sample mean over 
all values that represents all participants, sensors and activities 
(Section \ref{sec:overall_minMT}).
Hence, the sample mean for the minimum values of $E_{1}(m)$ from 
Figs~\ref{fig:caoH} and \ref{fig:caoV} is $\overline{m}_0=6$ and the sample 
mean for minimum values of AMIs from Figs~\ref{fig:amiH} and \ref{fig:amiV} 
is $\overline{\tau}_0=8$, for which the average minimum embedding parameters 
is ($\overline{m_0}=6$, $\overline{\tau_0}=8$).

Therefore, considering time series for participant 01 
(Figs \ref{fig:tsH}, \ref{fig:tsV}) the reconstructed state spaces
for horizontal arm movements (Figs~\ref{fig:rss_aHw10}) and
 vertical arm movements  (Figs~\ref{fig:rss_aVw10}) 
are computed with $\overline{m_0}=6$ and $\overline{\tau_0}=8$ 
(Section \ref{sec:rsswithUTDE}).
%%---------------------------------(FIGURE)-------------------------------------
\begin{figure}
\centering
\includegraphics[height=0.85\textheight]{rss_aH}
\caption{
	{\bf RSSs for horizontal arm movements.}
	Reconstructed state spaces %for time series of Figure \ref{fig:tsH}.
	of participant p01 for horizontal movements in normal and faster 
	velocity (HN, HF) with raw-normalised (sg0zmuvGyroZ), 
	normalised-smoothed 1 (sg1zmuvGyroZ) and 
	normalised-smoothed 2 (sg2zmuvGyroZ) time series of the 
	sensors attached to the participant (HS01) and other sensor 
	attached to the robot (RS01).	
	Reconstructed state spaces were computed with 
	embedding parameters $m=6$, $\tau=8$.
	R code to reproduce the figure is available from \cite{hwum2018}.
        }
    \label{fig:rss_aHw10}
\end{figure}
%%---------------------------------(FIGURE)------------------------------------
%%---------------------------------(FIGURE)-------------------------------------
\begin{figure}
\centering
\includegraphics[height=0.85\textheight]{rss_aV}
    \caption{
	{\bf RSSs for vertical arm movements.}
	Reconstructed state spaces %for time series of Figure \ref{fig:tsV}.
	of participant p01 for vertical movements in normal and faster 
	velocity (VN, VF) with raw-normalised (sg0zmuvGyroZ), 
	normalised-smoothed 1 (sg1zmuvGyroZ) and 
	normalised-smoothed 2 (sg2zmuvGyroZ) time series of the 
	sensors attached to the participant (HS01) and other sensor 
	attached to the robot (RS01).	
	Reconstructed state spaces were computed with 
	embedding parameters $m=6$, $\tau=8$.
	R code to reproduce the figure is available from \cite{hwum2018}.
        }
    \label{fig:rss_aVw10}
\end{figure}
%%---------------------------------(FIGURE)------------------------------------


The trajectories of the RSSs for horizontal normal and faster from the 
human sensors (HS01) are slightly smoothed as the time-series 
smoothness increase (Figs~\ref{fig:rss_aHw10}(A,C)). Similarly, 
the smoothness of the trajectories in the RSSs for robot sensor (RS01) 
is increasing as the time series smoothness increase 
(Figs~\ref{fig:rss_aHw10}(B,D)). 
Although the frequency of the movement increase from normal to faster velocity, 
the trajectories RSSs in Figs~\ref{fig:rss_aHw10}(B)
show highers oscillations specially for a maximum values of smoothness
(sg2zmuvGyroZ), while the trajectories in the RSS for HF in 
Figs~\ref{fig:rss_aHw10}(D) show a lower and smoothed oscillations 
as the smoothness increase.

In contrast, the time series for vertical movements are less noisy and 
well structured (Figs \ref{fig:tsV}) for which the trajectories in the RSSs 
seem to be less organised, specially for Fig \ref{fig:rss_aVw10}(A,C), 
while time series for vertical faster movements (VF) which have more 
periods (Figs \ref{fig:tsV}), this created trajectories in the RSS with 
well defined patters (\ref{fig:rss_aVw10}(C,D)).
It is important to note that the smoothness of time series also create 
an effect on smoothness in the trajectories of the RSS, being the RS01 
more organised and more persistent while trajectories for HS01 are 
more changeable (Figs. \ref{fig:rss_aHw10}, \ref{fig:rss_aVw10}).

Therefore, one can observe by eye the differences in each of the trajectories 
in the reconstructed state spaces 
(Figs~\ref{fig:rss_aHw10}, \ref{fig:rss_aVw10}), 
however one might be not objective when quantifying those differences 
since such observations might vary from person to person.
With that in mind, in our early experiments, we tried to objectively 
quantify those differences using euclidean distances between 
the origin to each of the points in the trajectories in the trajectories of 
the RSSs, however these created suspicious metrics, specially 
for trajectories which looked very messy.
Hence, we considered to apply Recurrence Quantification Analyses in order 
to have a more objective quantification of the differences in each of the 
cases of the time series.


\newpage
\section{Recurrences Plots}
With the time series of Figs~\ref{fig:tsH} and \ref{fig:tsV}, 
we computed its Recurrence Plots for horizontal arm movements 
(Fig~\ref{fig:rp_aH}) and vertical arm movements (Fig~\ref{fig:rp_aV}) 
using the average embedding parameters ($m=6$, $\tau=8$) and a recurrence 
threshold of $\epsilon=1$. For the selection of the recurrence threshold,
\cite{marwan2011} pointed out that choosing an appropriate 
recurrence threshold is crucial to get meaningful representations in the RPs, 
however, for this thesis where quantifying movement variability is our aim,
we give little importance to the selection of the recurrence threshold 
for the RPs as long as it is able to represent the dynamical transitions 
in each of the time series.

Generally, the increase of smoothness in time series results in thicker 
and better defined diagonal lines in the RPs 
(Figs~\ref{fig:rp_aH}, \ref{fig:rp_aV}) 
Regarding the low and high frequencies in the time series, due to the 
changes in velocities of the movements, the patterns in the RPs 
show both an increase of diagonal lines and a decrease of line thickness
(Figs~\ref{fig:rp_aH}(A,B), \ref{fig:rp_aV}(C,D)).
Although, the patterns of RPs show consistency with the movements type 
and velocities changes, it can be noticed that patterns of the RPs for 
HS01 are not well defined while patterns of the RPs for RS01 
shown a more consistent pattern (Fig~\ref{fig:rp_aH}, \ref{fig:rp_aV}). 

It is important to note that only RPs for participant 01 are presented
in (Fig~\ref{fig:rp_aV}, \ref{fig:rp_aH}), however
other RPs for all participants are presented in Appendix \ref{appendix:d:rps}.
With that in mind, we can highlight that, as similar as, the 
Reconstructed State Spaces (Figs~\ref{fig:rss_aHw10}, \ref{fig:rss_aVw10}), 
the patterns in the RPs can be easily noticed by eye for different conditions 
of the time series (Figs~\ref{fig:rp_aH}, Fig~\ref{fig:rp_aV}),
however these characteristics in the patterns of the RPs are subjective 
for the person who analysed them and might vary from person to person. 
That lead us to apply Recurrence Quantification Analysis in order to have 
a more objective quantification for the movement variability for each of 
the conditions of the time series.
%%---------------------------------(FIGURE)-------------------------------------
\begin{figure}
\centering
\includegraphics[height=0.85\textheight]{rp_aH}
\caption{
	{\bf RPs for horizontal arm movements.}	
	Recurrence plots %for time series of Figure \ref{fig:tsV}.
	of participant $p01$ for horizontal movements in normal and faster 
	velocity (HN, HF) with raw-normalised (sg0zmuvGyroZ), 
	normalised-smoothed 1 (sg1zmuvGyroZ) and 
	normalised-smoothed 2 (sg2zmuvGyroZ) time series of the 
	sensors attached to the participant (HS01) and other sensor 
	attached to the robot (RS01).
	Recurrence plots were computed with 
	embedding parameters $m=6$, $\tau=8$ and $\epsilon=1$.
	R code to reproduce the figure is available from \cite{hwum2018}.
        }
    \label{fig:rp_aH}
\end{figure}
%%---------------------------------(FIGURE)------------------------------------
%%---------------------------------(FIGURE)-------------------------------------
\begin{figure}
\centering
\includegraphics[height=0.85\textheight]{rp_aV}
\caption{
	{\bf RPs for vertical arm movements.}	
	Recurrence plots %for time series of Figure \ref{fig:tsV}.
	of participant $p01$ for vertical movements in normal and faster 
	velocity (VN, VF) with raw-normalised (sg0zmuvGyroZ), 
	normalised-smoothed 1 (sg1zmuvGyroZ) and 
	normalised-smoothed 2 (sg2zmuvGyroZ) time series of the 
	sensors attached to the participant (HS01) and other sensor 
	attached to the robot (RS01).
	Recurrence plots were computed with 
	embedding parameters $m=6$, $\tau=8$ and $\epsilon=1$.
	R code to reproduce the figure is available from \cite{hwum2018}.
        }
    \label{fig:rp_aV}
\end{figure}
%%---------------------------------(FIGURE)------------------------------------




\newpage
\section{Recurrence Quantification Analysis}
Considering the RPs for 20 participants performing four activities 
(HN, HF, VN and VF) with sensors attached to the human (HS01) and to the 
humanoid robot (RS01) and with the increase of smoothness 
(sg0zmuvGyroZ, sg1zmuvGyroZ and sg2zmuvGyroZ), 
we hence compute four metrics of RQA metrics (REC, DET, RATIO and ENTR) with 
embedding parameters $m=6$, $\tau=8$ and recurrence threshold $\epsilon=1$ 
shown in the following subsections.

\newpage
\subsection{REC values}
%It can be seen in Figs~\ref{fig:rec_aH} and \ref{fig:rec_aV} 
%that REC values, representing the \% of black dots in the RPs, 
%are more spread for HN than HF movements with time 
%series coming from HS01 sensor. 
%In contrast, REC values appear to be constant and present little variation 
%for both HN and HF movements with time series from the sensor attached 
%to the humanoid robot RS01.
%With regard to the increase of smoothness of time series 
%(sg0zmuvGyroZ, sg1zmuvGyroZ and sg2zmuvGyroZ), REC values present little 
%variation as the smoothness is increasing for time series from HS01 and 
%REC values more similar as the smoothness is increasing for data from RS01.
%
%



%%---------------------------------(FIGURE)-------------------------------------
\begin{figure}
\centering
\includegraphics[width=0.9\textwidth]{rec-bp}
    \caption{
	{\bf REC values for horizontal arm movements.}	
	REC values (representing \% of black dots in the RPs) for 
	20 participants performing HN and HF movements
	with sensors HS01, RS01 and three smoothed-normalised axis 
	of GyroZ (sg0zmuvGyroZ, sg1zmuvGyroZ and sg2zmuvGyroZ).
	REC values were computed with 
	embedding parameters $m=6$, $\tau=8$ and $\epsilon=1$
	R code to reproduce the figure is available from \cite{hwum2018}.
        }
    \label{fig:rec_aH}
\end{figure}
%%---------------------------------(FIGURE)------------------------------------






\newpage
\subsection{DET values}

%%---------------------------------(FIGURE)-------------------------------------
\begin{figure}
\centering
\includegraphics[width=1.0\textwidth]{det-bp}
    \caption{
	{\bf DET values for horizontal arm movements.}	
    	DET values (representing predictability and organisation of the RPs)
	for 20 participants performing HN and HF movements
	with sensors HS01, RS01 and three smoothed-normalised axis 
	of GyroZ (sg0zmuvGyroZ, sg1zmuvGyroZ and sg2zmuvGyroZ).
	DET values were computed with 
	embedding parameters $m=6$, $\tau=8$ and $\epsilon=1$.
	R code to reproduce the figure is available from \cite{hwum2018}.
        }
    \label{fig:det_aH}
\end{figure}
%%---------------------------------(FIGURE)------------------------------------


\newpage
\subsection{RATIO values}
%%---------------------------------(FIGURE)-------------------------------------
\begin{figure}
\centering
\includegraphics[width=1.0\textwidth]{ratio-bp}
    \caption{
	{\bf RATIO values for horizontal arm movements.}
	RATIO (representing dynamic transitions) for 
	20 participants performing HN and HF movements
	with sensors HS01, RS01 and three smoothed-normalised axis 
	of GyroZ (sg0zmuvGyroZ, sg1zmuvGyroZ and sg2zmuvGyroZ).
	RATIO values were computed with 
	embedding parameters $m=6$, $\tau=8$ and $\epsilon=1$.
	R code to reproduce the figure is available from \cite{hwum2018}.
        }
    \label{fig:ratio_aH}
\end{figure}
%%---------------------------------(FIGURE)------------------------------------



\newpage
\subsection{ENTR values}
%%---------------------------------(FIGURE)-------------------------------------
\begin{figure}
\centering
\includegraphics[width=1.0\textwidth]{entr-bp}
    \caption{
	{\bf ENTR values for horizontal arm movements.}
    	ENTR values (representing the complexity of the deterministic 
	structure in time series) for 
	20 participants performing HN and HF movements
	with sensors HS01, RS01 and three smoothed-normalised axis 
	of GyroZ (sg0zmuvGyroZ, sg1zmuvGyroZ and sg2zmuvGyroZ).
	ENTR values were computed with 
	embedding parameters $m=6$, $\tau=8$ and $\epsilon=1$.
	R code to reproduce the figure is available from \cite{hwum2018}.
        }
    \label{fig:entr_aH}
\end{figure}
%%---------------------------------(FIGURE)------------------------------------
%




%
%
%%% \subsection{Effects of different parameters in the computation of 
%%% different metrics of RQA.}
%%Then we only select the axis AccY and GyroZ as being the axis which show 
%%better consistency in the patters for all the posibilities int he time series.
%%That was doing visual inspection. It also worthwhile to note that those axis
%%represent the majoy energy amothn other axis for both sensors.
%%The selection of recurrecne threshold is 1 for HF activites,
%%however this should be changed to
%%for HN activies.
%%With that we also can observe the effect of the seletion 
%%of recurrence threshold for different actibities is crucial 
%%to have meaninign values in the metrics of RQA.
%%% added: Tue 19 Jun 2018
%
%
%

%\section{RQA metrics with different embedding parameters, 
%recurrence thresholds, window lengths, levels of smoothness, and 
%time series structures.}
%

\newpage
\section{The weaknesses and strengths of RQA}
Considering the points in Section \ref{sec:ws_rqa} regarding 
the weaknesses and strengths of RQA, we computed RQA metrics 
(REC, DET, RATIO and ENTR) and plotted 3D surfaces using an unitary 
increase of pair embedding parameters 
($0 > m \le 10$, $0 > \tau \le 10$) 
and a decimal increase of 0.1 for recurrence thresholds 
($ 0.2 \ge \epsilon \le 3 $) (Fig.~\ref{fig:topo_rqas}). 
Hence, the 3D surface for REC values, representing the percentage of 
black docs in the RP, in Fig.~\ref{fig:topo_rqas}(A)
shows an increase for REC values as the recurrence threshold increase,
while the variation for embedding parameters creates slightly decrease 
of REC values as the dimension $m$ increase and even a more slighter 
decrements of REC values for the increase of $\tau$.
For the 3D surface of DET values (Fig.~\ref{fig:topo_rqas}(B)), representing 
predictability and organisation of the RPs, can be noted a plateau
for DET values near to 1 for embedding dimension parameters of less 
than 5 and recurrence threshold values of greater than 2. 
It can also be noted that the increases of delay embedding made 
the DET values increase so as to make an cascade effect in the surface 
along with the increase of dimension embedding $m$.
For RATIO values (Fig.~\ref{fig:topo_rqas}(C)),
representing dynamic transitions, the 3D surface show a plateau of RATIO values 
near to zero for recurrence thresholds greater than 1.0, while 
fluctuations are more evident for recurrence thresholds of less than 1.0,
particularly it can also be noted an increase in the fluctuations of 
RATIO values as the embedding dimension is increasing. 
For ENTR values in Fig.~\ref{fig:topo_rqas}(D), 
representing the complexity of the deterministic structure in time series, 
it can be noted that the increase of recurrence threshold is, 
not strictly linearly, proportional to the increase of ENTR values. 
It can also be seen that the increase of delay embeddings affects 
little the ENTR values for embedding dimensions of 1, while 
for higher values of embedding dimensions 
there is a decrease of ENTR values as the increase of the embedding dimension,
besides the decrease of ENTR values as delay dimension value is increasing.
%%---------------------------------(FIGURE)-------------------------------------
\begin{figure}[!ht]
\centering
\includegraphics[width=1.0\textwidth]{rqas}
    \caption{
	{\bf 3D surfaces for RQA metrics.}
	3D surfaces for (A) REC, (B) DET, (C) RATIO and (D) ENTR values 
	with increasing pair of embedding parameters 
	($0 \ge m \le 10$, $0 \ge \tau \le 10$) 
	and recurrence thresholds (  $ 0.2 \ge \epsilon \le 3 $).
	RQA metrics are computed with the time series of participant $p01$ using 
	HS01 sensor, HN activity, sg0zmuvGyroZ axis and 500 samples 
	for window size length.
        R code to reproduce the figure is available from \cite{hwum2018}.
	}
\label{fig:topo_rqas}
\end{figure}
%%---------------------------------(FIGURE)------------------------------------


\newpage
\subsection{Sensors and activities}
We also computed 3D surfaces of RQA metrics for different sensors 
and different activities 
(Figs.~\ref{fig:topo_sa_hs01}, \ref{fig:topo_sa_rs01}), where it can 
generally be noted similar 3D surface patterns for RQA metrics as the ones
in Fig. \ref{fig:topo_rqas}. 

The 3D surfaces for REC values (Fig. \ref{fig:topo_sa_hs01}(A))
show slightly differences with regard to vertical or horizontal activities
however there are notable differences for normal and faster velocities, 
specially for the faster movements where the 3D surfaces shown a maximum
REC value for embedding dimension values near to 1 and for recurrence 
thresholds near to 3. 
The 3D surfaces for DET values  
(Fig. \ref{fig:topo_sa_hs01}(B)) and RATIO values 
(Fig. \ref{fig:topo_sa_hs01}(C)) show slightly notable variations across 
the type of activities. 
For 3D surfaces of ENTR values it can be noted a slightly variation for
the surfaces of normal and faster velocities (Fig \ref{fig:topo_sa_hs01}(D)).
%%---------------------------------(FIGURE)-------------------------------------
\begin{figure}[!ht]
\centering
\includegraphics[width=1.0\textwidth]{sa_hs01}
    \caption{
	{\bf 3D surfaces of RQA metrics for HS01 sensor.}
	3D surfaces of RQA metrics ((A) REC, (B) DET, (C) RATIO, and (D) ENTR) 
	with increasing embedding parameters and recurrence thresholds 
	are for time series of participant $p01$ for 
	sensors HS01, activities (HN, HF, VN and VF) and 
	sg0zmuvGyroZ axis with 500 samples window size length. 
	R code to reproduce the figure is available from \cite{hwum2018}.
       }
\label{fig:topo_sa_hs01}
\end{figure}
%---------------------------------(FIGURE)-------------------------------------

As similar as Fig \ref{fig:topo_sa_hs01}, the 3D surfaces patters 
for RS01 in Fig \ref{fig:topo_sa_rs01} show the differences between 
the activities performed at normal and faster velocities
specially for REC and ENTR values (Fig \ref{fig:topo_sa_hs01}(A, D)),
while 3D surfaces for DET and RATIO values show slightly variations
(Fig \ref{fig:topo_sa_hs01}(B, C)).
%%---------------------------------(FIGURE)-------------------------------------
\begin{figure}[!ht]
\centering
\includegraphics[width=1.0\textwidth]{sa_rs01}
    \caption{
	{\bf 3D surfaces of RQA metrics for RS01 sensor.}
	3D surfaces of RQA metrics ((A) REC, (B) DET, (C) RATIO and (D) ENTR) 
	with increasing embedding parameters and recurrence thresholds 
	are for time series of humanoid robot for 
	sensors RS01, activities (HN, HF, VN and VF) and 
	sg0zmuvGyroZ axis with 500 samples window size length. 
	R code to reproduce the figure is available from \cite{hwum2018}.
       }
\label{fig:topo_sa_rs01}
\end{figure}
%---------------------------------(FIGURE)-------------------------------------


\newpage
\subsection{Window size}
3D surfaces for RQA metrics with four window size lengths
of 100, 250, 500 and 750 samples are shown in Fig.~\ref{fig:topo_windows}.
In general, the increase of samples in the time series creates 3D surface 
patterns with better resolution (Figs. \ref{fig:topo_windows}).
%---------------------------------(FIGURE)-------------------------------------
\begin{figure}[!ht]
\centering
\includegraphics[width=1.0\textwidth]{w}
    \caption{
	{\bf 3D surfaces for RQAs metrics with four window lengths.}
	3D surfaces of RQA metrics ((A) REC, (B) DET, (C) RATIO, and (D) ENTR) 
	with increasing embedding 
	parameters and recurrence thresholds for four window 
	lengths (w100, w250, w500 and  w750).
	RQA metrics values are for time series of participant $p01$ 
	using HS01 sensor, HN activity and sg0zmuvGyroZ axis.
	R code to reproduce the figure is available from \cite{hwum2018}.
        }
\label{fig:topo_windows}
\end{figure}
%%---------------------------------(FIGURE)------------------------------------


\newpage
\subsection{Smoothness}
Considering three levels of smoothness of the time series (sg0, sg1, sg2) 
to compute the 3D surfaces of the RQA metrics, it can be noted that such 
smoothness have a direct effect on the smoothness of the 3D surfaces.
Especially for dimension embeddings lower than 2 with the increase of 
delay embedding which is more evident for REC and ENTR values 
(Fig.~\ref{fig:topo_smoothness}(A, D)).
The 3D surfaces of DET values are smoothed to a degree that the plateau 
is increase, while RATIO values appear to be less affected to the level 
of smoothness (Fig.~\ref{fig:topo_smoothness}(C)).

%%---------------------------------(FIGURE)-------------------------------------
\begin{figure}[!ht]
\centering
\includegraphics[width=1.0\textwidth]{s}
    \caption{
	{\bf 3D surfaces for RQA metrics with three levels of smoothness.}
	3D surfaces of RQA metrics ((A) REC, (B) DET, (C) RATIO, and (D) ENTR) 
	with increasing embedding parameters and recurrence thresholds for 
	three levels of smoothness 
	(sg0zmuvGyroZ, sg1zmuvGyroZ and sg1zmuvGyroZ).
	RQA metrics are computed from time series of participant $p01$ using 
	HS01 sensor, HN activity and 500 samples window length.
	R code to reproduce the figure is available from \cite{hwum2018}.
 }
\label{fig:topo_smoothness}
\end{figure}
%%---------------------------------(FIGURE)------------------------------------



\newpage
\subsection{Participants}
3D surfaces of RQA metrics were also computed for three participants 
(Fig.~\ref{fig:topo_participants}).
Differences of the 3D surfaces across participants are more notable with 
REC (Fig.~\ref{fig:topo_participants}(A)) and 
ENTR values (Fig.~\ref{fig:topo_participants}(D)),
while minor differences of 3D surfaces across participants are 
presented in
DET (Fig.~\ref{fig:topo_participants}B)) and 
RATIO vales (Fig.~\ref{fig:topo_participants}(C)).
%%---------------------------------(FIGURE)-------------------------------------
\begin{figure}[!ht]
\centering
\includegraphics[width=1.0\textwidth]{p}
    \caption{
	{\bf 3D surfaces for RQA metrics with three participants.}
	3D surfaces of RQA metrics ((A) REC, (B) DET, (C) RATIO, and (D) ENTR) 
	for participants $p01$, $p02$ and $p03$ with increasing embedding 
	parameters and recurrence thresholds.
	RQA metrics values are for time series of HS01 sensor, 
	HN activity and 500 samples window length.
	R code to reproduce the figure is available from \cite{hwum2018}.
 }
\label{fig:topo_participants}
\end{figure}
%%---------------------------------(FIGURE)-------------------------------------


\newpage
\subsection{Final remarks}
%	You need to say whether the results are expected and
%	whether different methods agree or contradict each other. 	
Generally, it can be noted the changes for RQA metrics are evident
with both the increase of embedding dimension parameters and the 
recurrence threshold for different structures, window size, 
levels of smoothness of the time series. 
RATIO values present a plateau (blue colour surface) which is independently 
to the source of time series, however there are peaks that change 
differently based on the source of time series for embedding parameters 
increasing with recurrence threshold less than one.
For DET values, 3D surfaces present a fluctuated surface (red colour)
which slightly differs with the source of time series.
With regards to REC values, 3D surfaces are affected with the type of 
velocity, for instance, surfaces for normal velocity presents 
an increase of REC values as recurrence threshold increase and keeping 
slightly uniform surface changes for the increase of embedding parameters, 
however for faster velocity the 3D surface fluctuations decrease as 
the embedding dimension increase and recurrence thresholds increase.
Similar as the human-image activities, 3D surfaces for ENTR values in 
this experiment present changes for any source of time series,
making ENTR values a robust metric to quantify human-humanoid activities 
for analysis of movements variability from different time series.




%It is also important to highlight that the patterns in the 3D 
%surfaces of the RQA metrics (REC, DET, RADIO and ENTR) 
%(Fig \ref{fig:topo_rqas}) are certainly similar to its corresponded
%metrics for the different characteristics of the time series  
%(Figs. \ref{fig:topo_sa_hs01}, \ref{fig:topo_sa_rs01}, 
%\ref{fig:topo_windows}, \ref{fig:topo_smoothness}, 
%\ref{fig:topo_participants}).




