%*******************************************************************************
%******************************* Seventh Chapter *******************************
%*******************************************************************************
		\chapter{Conclusions, contributions and future work}
%*******************************************************************************


\section{Conclusions}
Considering the methods for nonlinear analyses to measure movement variability
and the experiments for human-image interaction and human-humanoid intereaction, 
we can conclude that nonlinear analyses with real-world data is possible. 
However, in the following sections, we will point out positives
and negatives of this thesis by answering the research questions.

%Although our experiment is limited to twenty healthy right-handed 
%participants of a range of mean 19.8 SD=1.39 age,
%we can conclude that thought 
%Considering the process to compute RQA metrics 
%(embedding parameters, RSSs, RPs), 
%can quantify human movement variability
%considering different conditions of the time series such as 
%window size length, levels of smoothness, axis, sensors and activities.
%
%
%%Such understanding and measurement of movement variability using
%%cheap wearable inertial sensors lead us to have a more intuitive 
%%selection of parameters
%%to reconstruct the state spaces and to create meaningful interpretations
%%of the recurrence plots and the results of the metrics with 
%%recurrence quantification 
%%analysis. 
%
%Similarly, such differences in time series created differences in each of the 
%RQA metrics, for instance, RATIO and ENTR are helpful to distinguish 
%differences in any of the categories of the time series (sensor, activity, 
%level of smoothness and number of participant), however for certain time series 
%(data from the sensor attached to the robot) seemed to have little variations 
%between each of the participants. The latter phenomena was in a way 
%evidently as robot degrees of freedom did not allow it to move with a 
%wide range of variability. 
%
%%In this thesis, an experiment is performed in the context of human-humanoid 
%%imitation activity to test nonlinear dynamics methods to quantify 
%%human movement variability. 
%%The presented results that illustrate the potential of nonlinear dynamics tools 
%%by providing a balanced review of positive and negatives aspects of each 
%%technique to quantitatively and qualitatively measure movement variability.
%%
%With regards to the visual inspection and understanding of the patters
%for reconstructed state spaces and recurrence plots,
%it can also be concluded that the performance of such tools is subjective 
%since biased personal data interpretation might be provided.
%Hence, without any bias, RQA metrics (REC, DET, RATIO and ENTR) help us 
%to show such differences of movement variability for difference categories 
%of the time series (participants, movements, axis type, window length 
%or levels of smoothness).
%Furthermore, it was noticed that each of the metrics of RQA show 
%the differences but particularly the metrics of RATIO and ENTR are 
%helpful to distinguish the differences in each of the categories 
%of the time series.
%
%Although RPs and metrics for RQA are independent of embedding 
%dimension \cite{iwanski1998}, it was found that recurrence threshold 
%values can modify the results for both RPs and RQA. This thesis has 
%carried out experiments on different activities in which the sensor's 
%axis was representative of difference of structures in the time series.
%
%
%
%
%%We therefore collecte data series using inertial sensors and we smooth
%%the signals to see its graphical effects and also in the metrics.
%%With that in mind, embedding values to create the reconstructe state spaces
%%and theferfore its recurrence plots. By doing that, we saw that visually
%%each of the particpants in each of the conditions for movemetns and 
%%levels of smootheness of the signlas are evicently differently, therefore
%%the challenge for us were to have a quantitavely method for each of the 
%%difference in the patterns for RP for which we took the adnavce of the use 
%%of Recurrene Qantification Analysis which show important results 
%%that help us to quantify the variality between particpants and between 
%%movments. We esentially noticed that each of the metrics of RQA
%%(REC, DET, RATIO and ENTR) can shown differences but specially RATIO
%%and ENTR are helpful to distinguis the differences in each of the movments.
%%%Tue 19 Jun 12:21:56 BST 2018
%
%
%%With that in mind we did the same for the selection 
%%of the right threshold for our particular problem where we first select 
%%a threhold of 1 for all the signals however, these value is not
%%appropriate for both activites, as for example the HN and HF 
%%show sometimes white RP which should not be the case if 
%%we select a right emedding threshodl.
%%However, we have found the following problems
%%% ENT
%%For RQA the window effect is crucial for each of the metrics
%%so for example, ENT values for HN are higher and HF are lower
%%meaming that these are less comples than HN values, we believe
%%that happens because of the lnght windows. Althought,
%%these values apper to be more complex for HF, 
%%the values in HN have less repetutions of tmovments 
%%which is the reason to have those differences in ENT values.
%%%#added Mon 18 Jun 12:32:55 BST 2018
%%For, RATIO values apper to have more variations across particpants
%%for which we believe that RATIO values represent a bit better
%%the variatbiltuy of imitation activitivies and also the 
%%movment variaiblaituy that is created in this experiemnt.
%%%added: Mon 18 Jun 14:06:19 BST 2018
%%and for ENTR values show little variation across partipants and these
%%are generally higher for HN than HF movmentes in each of the 
%%smothed signals. We believe that ENTR values are affected
%%by the windown lenght so as to say that HN values 
%%represent more complex structures than those coming from 
%%HF values.
%%%added: Mon 18 Jun 14:17:27 BST 2018
%
%
%%which is similar to the raw normalised data. Also the raw normalised
%%data can show more details information of for the movement, however
%%these are not lost as the time series is smoothed.
%%We can also conclude that finding the right balance between 
%%smoothness and the raw data to capture movement variability is 
%%a still a problem that has many avenues for exploration.
%%
%%other variables affect the data from the sensors such as  
%%temperature of the sensor processing, variation of the sampling
%%rate which esentially are involved in the quqlity of the data.
%% 
%%We only create two to four levels of smoothness using the 
%%savtiktzy-golay filter with same degree for different filter lenght
%%for which we were able to see the differences in each of the 
%%nonlinear dyamics tools. 
%%We also propose four window size lenght  to see the effects
%%in the nonlinear dynamics tools.
%%%add more conclusions about the reuslts of the changes in rss, rp and rqa
%%%as these parameters chagne.
%%\subsection{Perception of speed}
%
%
%
%
%%to understand and quantify movement variability using nonlinear dynamics tools.
%%With regard to the humanoid movements, I realise that
%%it is imporant to program the robot with using the same speed
%%and also considering movements that the robot can perform, 
%%so for example when the speed is a bit higher the 
%%robot's movements tend to be jerky.
%%Also create uniform speeds of each of the movments, 
%%I realise the the horizontal and vertical movements in 
%%normal and faster speed were different which might 
%%affect the perception of people movements.
%



\subsection{What are the effects 
	of different parameters for nonlinear analyses 
	with different characteristics of time series?}
Generally, it is evidently that time series from different sources 
of time series (participants, movements, axis type, window size lengths or 
levels of smoothness) will present differences for not only 
the computation time of the embedding parameters but also for the 
patterns in RRSs, RP, RQAs and 3D surfaces of RQA metrics. 

%With that in mind, we can say that all begins with the selection of 
%embedding parameters ...
%was our first challenge where we computed embedding parameters for 
%each time series and then computed a sample mean over all time series 
%in order to get two embedding parameters to compute all RSSs with 
%its corresponded type of movement.
%Then we found that the quantification of variability with regard to the 
%shape of the trajectories in RSSs requires more investigation since 
%our original proposed method base on euclidean metric failed to 
%quantify those trajectories. Specially, for trajectories 
%which were not well unfolded. With that in mind, we proceed to take 
%advantage of four RQA metrics (REC, DET, RATIO and ENTR) in order 
%to avoid any subjective interpretations or personal bias with 
%regard to the evolution of the trajectories in RSSs.
%

\subsection{What are the weaknesses and strengths of RQA metrics 
	when quantifying MV?}
It can be noted that not only the activity type, window size length and 
structure of the time series affects the values of RQA metrics but also 
certain RQA metrics are better to describe the dynamics of a determined 
type of movement.
% (predicability, organisation of the RPs, dynamics transitions, 
%or complexity and determinism) with is explained with more detail in the 
%following sections.

%However, we believe that further investigation is required to find the 
%right balance between the level of smoothness of the signal
%and defining what is the aim of RQA where 
%its representations using RSS, RP and RQA.
%Specially, where the level of smoothness does not affect 
%the variation of each of the movements quantification. 
%%We can also conclude that finding the right balance between 
%%smoothness and the raw data to capture movement variability is 
%%a still a problem that has many avenues for exploration.

\subsubsection{RQA metrics with fixed parameters}
We found the following when RQA metrics were computed with fixed embedding 
parameters ($m=6$ and $\tau=8$) and recurrence thresholds ($\epsilon=1$). 
REC values, representing the \% of black points 
in the RPs, were more affected with an increase for normal arm movements 
(HN and VN) than for faster velocity arm movements (HF and VF) 
with the sensor attached to the participants (HS01). 
Such decrease of REC values from normal to faster velocity arm movements 
is also presented in the time series from the sensor attached 
to the robot (RS01), and REC values for RS01 appear to be more 
constant than those from HS01.
 
DET values, representing predictability and organisation in 
the RPs, present little variation in the any of the time series and 
little can be said but the effect of the increase of smoothness of 
time series which made DET values appear to be more similar and constant. 
In contrast, RATIO values, which represent dynamic 
transitions, were more variable for arm movements performed at faster
velocity (HF and VF) than normal velocity (HN and VN) 
with the sensor attached to the participants (HS01). 
For time series from the sensor attached to the robot (RS01), 
RATIO values for horizontal arm movements (HN, HF) 
appear to vary more than values coming from vertical arm movements (VN, VF).
With that in mind, it can be said that RATIO values can represent
better movement variability than the use of REC or DET metrics, 
particularly their dynamics transitions of imitation activities 
in each of the conditions for time series.

In the same way as the previous metrics, ENTR values for HN arm movements
were higher than values for HF arm movements and ENTR values varied more 
for sensor attached to participants (HS01) 
than ENTR values for sensors of the robot (RS01). It is evidently that 
the higher the ENTR metric is, the more complex the dynamics of the movements 
are, however, ENTR values for HN appear a bit higher than HF values.
With that in mind, we hypothesise this happens because of the structure 
the time series appear more complex for HN than HF arm movements 
(presenting less stability at normal velocity).

We also explored the effect of smoothness of raw-normalised time series 
for RQA metrics where, for instance, REC and DET values 
appear to be constant. Hence, REC and DET values were little 
affected by the smoothness of time series. 
However, the effect of smoothness can be well noticed for both
RATIO and ENTR values where a slightly but notable decrease in the amplitude 
of the values in any of the time series conditions is presented.

\subsubsection{RQA metrics with different parameters}
Patterns in RPs and metrics for RQA are independent of embedding 
dimension parameters \citep{iwanski1998}, however, that is not the case 
when using different recurrence thresholds. 
Hence, 3D surfaces of RQA with increments of embedding parameters and
recurrence thresholds were computed to show their variations with respect 
to different characteristic of the time series such as window size length,
participants, sensors and levels of smoothness.
In general, it can be noted that the patterns in 3D surfaces of RQA 
are sensible to the increase of embedding parameters and recurrence threshold,
meaning that stability of RQA metrics is dependant on changes of 
embedding parameters and recurrence thresholds. 

%*HII
%*HRI


\subsection{How the smoothing of raw time series affects the 
	nonlinear analyses when quantifying MV?}
The answer depends on what one needs to measure, for instance, to 
avoid erratic changes in the metrics, smoothing the raw signals helps
to have a more defined and constant metric for different sources of time 
series. In contrast, when using raw data, the 
metrics might create a closer representation of the nature of movement 
variability.

Nonlinear tools are generally affected by the smoothness, 
showing mainly proportional smoothness in the metrics. 
Also some RQA metrics (e.g. DET and  ENTR) are more robust to the 
effect of smoothness of time series.

Additionally, it was also found that using different levels of smoothness
for time series helps to visualise the variations of movements 
between participants (e.g. RSSs, RPs and RQA).
It is important to mention that some RQA's metrics (e.g. DET and  ENTR) 
are more robust to the effect of smoothness of time series.
However, we believe that further investigation is required to find the 
right balance between the level of smoothness of the signal
and its representations with RSS, RP and RQA.
%Particularly, where the level of smoothness does not affect 
%the variation of each of the movements' quantification.



\section{Contributions}
%	How does your work extend and advance the field?\\
%	(p. 73)
The contribution to knowledge in this thesis is with regards
to experimental work that test the weaknesses and strengths of 
nonlinear dynamics tools with real-world data in the context of 
human-humanoid interaction, specially with the use of RQA metrics.
Hence, thorough the visualization of 3D surface patterns of RQA metrics, 
it was found that RQA metrics are not only dependent on dimension 
parameters but dependent on recurrence thresholds, which is an extension 
of the work of \cite{iwanski1998} who pointed out that RQA metrics 
are independent of dimension parameters.
In this thesis, it was also found that the patterns of 3D surfaces 
of ENTR values can be used to model any of the effects of movement 
variability of the activities as well as the post processing of 
time series.



\section{Future work}

\subsection{Inertial sensors}
To have fundamental understating of the nature of signals collected 
through inertial sensor in the context of human-robot interaction,
future experiments can be conducted considering the application of 
derivates to the acceleration data. 
With that in mind, it can then explore 
(i) the jerkiness of movements and therefore the nature of arm movements 
which typically have minimum jerk \citep{flash1985},
(ii) the relationship with different body parts, for instance, 
how rapid or slowly one perform arm and legs movements as we grow up 
\citep{devries1982, mori2012} or (iii) 
the application to time series of higher derivatives of displacement 
with respect time such as jounce, snap, crackle and pop \citep{eager2016}.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%Thu 10 May 13:10:45 BST 2018
%Considering the work of \cite{shoaib2016},
%futher experimets can be permoed with the combination of linear acceleartion
%n, which is obtained by removing acceleration due to 
%gravity from the accelerometer, with accelerometer and gyroscope.
%"the acceleration due to gravity is useful for differentiating static postures
%such as sitting and standing" but it is sensitive to changes in 
%sensor orientation and body position.
%
%[Florentino-Liano, B.; O’Mahony, N.; Artés-Rodríguez, A. 
%Human activity recognition using inertial sensors
%with invariance to sensor orientation. 
%In Proceedings of the 2012 3rd IEEE International Workshop on
%Cognitive Information Processing (CIP), 
%Baiona, Spain, 28–30 May 2012; pp. 1–6.]




\subsection{Nonlinear analyses}
While working with different nonlinear analyses we bumped into 
interesting areas that will be part of our future lines of research.

\subsubsection{Embedding parameters}
When using the False Nearest Neighbour method of \cite{Cao1997}, where 
the values for $E_1(m)$ stop changing to find the minimum embedding 
dimension, a threshold should be defined in order to obtain the minimum 
embedding dimension $m_0$. Hence, a further investigation is required 
for the selection of the threshold in the $E_1(m)$, as the selection 
of the threshold in this thesis is only based on no particular method 
but visual inspection of the $E_1(m)$ curves.

Similarly, further research is required to be done with regards to the 
selection of the minimum delay embedding because it is not clear:
(i) why the choose of the first minimum of the AMI is the minimum delay 
embedding parameter \citep{kantz2003} or 
(ii) why the probability distribution of the AMI function 
is computed with the use of histograms which depends on a heuristic 
choice of number of bins for the AMI partitioning \citep{garcia2005e71}. 
Additionally, "the AMI method is proposed for two dimensional 
reconstructions and extended to be used in a multidimensional case 
which is not necessarily hold in higher dimensions" 
\citep[p. 156]{gomezgarcia2014}.


\subsubsection{Other methodologies for state space reconstruction.}
In addition to the Uniform Time-Delay Embedding method to reconstruct
state spaces other methods have been investigated stating a better 
dynamic representations of time series in the reconstructed state spaces 
such as:
(i) the nonuniform time-delay embedding methodology  
where the consecutive delayed copies of $\{ \boldsymbol{x}_n  \} $ are not
equidistant. Such method has been proved to create better representations 
of the dynamics of the state space to analyse quasiperiodic 
and multiple time-scale time series, and  
\citep{pecora2007, uzal2011, 
Quintana-Duque2012, Quintana-Duque2013, Quintana-Duque2016}, and
(ii) uniform 2 time-delay embedding method which takes advantage 
of finding an embedding window instead of the traditional method 
of finding the embedding parameters separately \citep{gomezgarcia2014}.
%In general, uniform 2 time-delay embedding method computes $m$ with 
%False Nearest Neighbour (FNN) algorithm and $\tau$ is computed as 
%$\tau= d_w / (m-1)$, where $d_w$ is given by the minimisation of the 
%Minimum Description Length \citep{small2004}.


\subsubsection{RQA parameters}
Having presented our results with RQA metrics, we believe that further 
investigation is required to have a better understanding of the RQA metrics
and ensure its robustness in many of its applications. 
For example, \cite{marwan2007} and 
\cite{marwan2015} reviewed different aspects to 
compute RPs using different criteria for neighbours, 
different norms ( $L_{1-norm}$, $L_{2-norm}$, or $L_{\infty-norm}$ ) or 
different methods to select the recurrence thresholds such as 
using only certain percentage of the signal
($\sqrt{m_0} \times$ 10\% of the fluctuations of the time series)
\citep{letellier2006}, select a determined amount of noise or 
using a factor based on the standard deviation of the 
observational noise \cite{marwan2007}.


\subsubsection{Advanced RQA quantifications}
In addition to the applied RQA metrics (REC, RATIO, DET and ENTR) for 
recurrence quantification, 
we believe that other line of future research for this thesis is the 
investigation of further quantification methodologies of the RP based 
on complex networks statics, calculation of dynamic invariants, 
study of the intermittency in the systems, applying different windowing 
techniques or the study of bivariate recurrence analysis for correlations, 
couplings, coupling directions or synchronisation between dynamical systems
\citep{marwan2007, marwan2015}.


\subsection{Variability in perception of velocity}
While conducting the experiments with different arm movements 
velocities (e.g. normal and faster), we realised that participants 
perceive velocity differently, shedding light for a have better 
understanding on why each participant perceive body movement velocity 
differently and how to quantify such variability of perception of movement.
For instance, some participants considered a normal velocity movement 
as a slow velocity movement and some others considered a 
slow velocity movement as being performed in normal velocity. 
With that in mind, we hypothesise that the differences in perception of 
velocities are related to the background of each person, for example,
persons who have received musical training in their infancy
are more aware of their body movements. %[add reference]
It would also be interesting to ask participants to move in three 
different velocities without any constrain in order to capture 
the natural movements of slow, normal and faster velocity arm movements. 

\subsection{A richer dataset of time series}
It should also be highlighted that the experiments for this thesis are 
limited to twenty three healthy right-handed participants of a 
range age of mean 19.8 and SD=1.39, for which participants of 
different ages, state of health and anthropomorphic features 
would create a richer dataset of time series.



%It is also important to note that we considered the use of normalised raw 
%time series from the inertial sensors, however, performing the 
%reconstructed state space 
%require a dimensionality recudtion using PCA where another noramlisation 
%of data is performed for such dimensioanlity reduction.
%In constrast, computing RPs and RQAs require the creating of an UTDE matrix, 
%however, there is no extra normalisation than the normalised 
%raw data of the input 
%of RPs and RQAs.
%added: Fri 20 Jul 00:48:14 BST 2018

%
%FUTURE WORK FOR RQA
%Similarly, Iwansky et al. \cite{iwanski1998} pointed out that 
%two dissimilar RPs: 
%one from the R\"{o}ssler system and the other one from 
%a sine-wave signal of varying 
%period have got equal values of REC (2.1\%) and near-equal values of 
%DET (42.9\%, 45.8\%, respectively). Where we believe other RQA's can be more 
%realiable for certain source of the time series.
%added: Fri 20 Jul 01:12:50 BST 2018
%




%HUMAN_HUMANOID IMTAITON APPLICAITONS
%The work of \cite{guneysu2014} raised an important point of not considering 
%latency of motions for velocity or symmetry of motion which can be used as 
%indicators of attention deficit, boredom, or lack of perception.
%Tue 31 Jul 19:22:29 BST 2018



% Investigate \section{Group Activity in Human-Humanoid Imitation}
%added Thu  2 Aug 21:56:20 BST 2018


%future work with more participants in a more
%controlled experiment
%With that in mind, we conclude that 
%quantification of human-humanoid imitation activities is possible for 
%participants of different ages, state of health and anthropomorphic features.
%
%

